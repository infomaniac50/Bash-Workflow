#!/bin/bash

implemented="Only aliases, functions, and files are currently implemented."

function usage()
{
  cat <<EOF
meta [-tf] <alias|function|script>
Prints the definition of any alias, function, or executable shell script.

Example:
meta meta # Prints self. Very Meta!
EOF
}

function fail()
{
  exit 1
}

function pass()
{
  exit 0
}

function main()
{
  local file="$1"

  case $(type -t "$file") in
    function)
      echo -n "function "
      type "$file" | tail -n+2
      ;;
    alias)
      alias "$file"
      ;;
    file)
      file=`type -fp "$file"`
      mime=$(file --brief --mime-type "$file")

      if [[ -f "$file" && $mime == text* ]]; then
        cat "$file"
      else
        echo "Binary File"
        echo $mime
      fi
      ;;
    *)
      echo $implemented
      ;;
  esac
}

if [[ -z "$1" ]]; then
  usage
  fail
  return 1
fi

main $@